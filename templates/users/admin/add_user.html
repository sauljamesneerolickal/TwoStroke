{% extends 'users/admin/admin_layout.html' %}
{% block admin_title %}Add New User{% endblock %}
{% block admin_content %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const passwordInputs = document.querySelectorAll('input[type="password"]');

        passwordInputs.forEach(input => {
            const wrapper = input.closest('.field-wrapper');
            if (wrapper) {
                // Adjust input padding
                input.style.paddingRight = '45px';

                // Create toggle button
                const toggleBtn = document.createElement('button');
                toggleBtn.type = 'button';
                toggleBtn.className = 'btn btn-link position-absolute end-0 top-0 mt-2 me-2 text-secondary text-decoration-none p-0 toggle-password';
                toggleBtn.style.zIndex = '10';
                toggleBtn.innerHTML = '<i class="bi bi-eye"></i>';

                // Insert button into wrapper
                wrapper.appendChild(toggleBtn);

                // Toggle Logic
                toggleBtn.addEventListener('click', function () {
                    const icon = this.querySelector('i');
                    if (input.type === 'password') {
                        input.type = 'text';
                        icon.classList.replace('bi-eye', 'bi-eye-slash');
                    } else {
                        input.type = 'password';
                        icon.classList.replace('bi-eye-slash', 'bi-eye');
                    }
                });
            }
        });
    });
</script>
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="glass-card shadow-sm border-0 animate-fade-in">
            <h4 class="text-dark fw-bold mb-4">Create New Account</h4>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="row g-3">
                    {% for field in form %}
                    <div class="col-md-12">
                        <label class="form-label small text-muted text-uppercase fw-bold">{{ field.label }}</label>
                        <div class="position-relative field-wrapper">
                            {{ field }}
                            {% if field.help_text %}
                            <small class="form-text text-muted d-block mt-1">{{ field.help_text }}</small>
                            {% endif %}
                        </div>
                        {% if field.errors %}
                        <div class="text-danger small mt-1">{{ field.errors|striptags }}</div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                <div class="mt-4 pt-3 border-top d-flex justify-content-end gap-3">
                    <a href="{% url 'admin_users' %}" class="btn btn-light rounded-pill px-4 fw-bold">Cancel</a>
                    <button type="submit" class="btn btn-primary rounded-pill px-5 fw-bold shadow-sm">Create
                        User</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}